<div class="card h-100 filament-card {% if spool.is_in_use %}in-use-border{% elif spool.is_drying %}drying-border{% endif %}">
    <div class="card-header d-flex justify-content-between align-items-center">
        <span class="badge bg-dark font-monospace">{{ spool.short_id }}</span>
        <span class="fw-bold">{{ spool.filament_type.manufacturer }}</span>
    </div>

    <div class="card-body d-flex flex-column">
        <div class="spool-visualization mb-3">
            <div class="spool-filament-color" style="background-color: {{ spool.filament_type.color_hex }};"></div>
            
            {% if spool.filament_type.is_color_light() %}
                <img src="{{ url_for('static', filename='spule_cover_dark.png') }}" class="spool-cover" alt="Dunkles Spulen-Cover">
            {% else %}
                <img src="{{ url_for('static', filename='spule_cover_light.png') }}" class="spool-cover" alt="Helles Spulen-Cover">
            {% endif %}
        </div>

        <h5 class="card-title fs-6">{{ spool.filament_type.name }} <span class="badge bg-secondary fw-normal">{{ spool.filament_type.material_type }}</span></h5>
        
        <p class="card-text text-muted mb-2 small">
            {% if spool.is_drying %}
                <i class="bi bi-thermometer-sun text-warning"></i> <strong>Im Trockner (Dryer)</strong>
            {% elif spool.assigned_printer %}
                <i class="bi bi-printer-fill text-success"></i> <strong>{{ spool.assigned_printer.name }}</strong>
            {% else %}
                <i class="bi bi-box-fill text-secondary"></i> Im Lager
            {% endif %}
        </p>

        <div class="mt-auto">
            <div class="d-flex justify-content-between small">
                 <span>{{ spool.current_weight_g }}g</span>
                 <span>{{ spool.initial_weight_g }}g</span>
            </div>
            <div class="progress" style="height: 15px;">
                <div class="progress-bar" role="progressbar" 
                     style="width: {{ spool.remaining_percentage }}%; background-color: {{ spool.filament_type.color_hex }};" 
                     aria-valuenow="{{ spool.remaining_percentage }}" aria-valuemin="0" aria-valuemax="100">
                     <small>{{ spool.remaining_percentage }}%</small>
                </div>
            </div>
        </div>
    </div>
    <div class="card-footer text-center p-2">
         <a href="{{ url_for('materials_bp.manage_spools', type_id=spool.filament_type.id) }}" class="btn btn-sm btn-outline-secondary w-100">
             <i class="bi bi-gear-fill"></i> Spulen verwalten
         </a>
    </div>
</div>